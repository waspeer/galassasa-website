---
import { toHTML } from '@portabletext/to-html';
import classNames from '@sindresorhus/class-names';
import { imageUrlFor } from '../lib/sanity';
import type { StudioInfo } from '../lib/types';
import s from './over-de-studio.module.css';

interface Props {
  studioInfo: StudioInfo;
}

const { studioInfo } = Astro.props;

const extractInstagramUsername = (url: string) => (url.match(/([^/]+)\/?$/) ?? [])[1];
---

<main class={s.wrapper}>
  <h1>Over de Studio</h1>

  <div class={s.shortDescription}>{studioInfo.shortDescription}</div>

  {
    studioInfo.description.map(({ image, text, title }) => (
      <div class={s.textBlock}>
        <div
          class={classNames(s.image, s.portrait)}
          style={{
            backgroundImage: `url(${imageUrlFor(image).minHeight(350).minWidth(130).url()})`,
          }}
        />
        <div
          class={classNames(s.image, s.landscape)}
          style={{
            backgroundImage: `url(${imageUrlFor(image).height(75).width(450).url()})`,
          }}
        />

        <h2>{title}</h2>

        <div class={s.text} set:html={toHTML(text)} />
      </div>
    ))
  }

  <dl class={s.contact}>
    <dt>Mail</dt>
    <dd>
      <a href={`mailto:${studioInfo.email}`}>{studioInfo.email}</a>
    </dd>

    <dt>Instagram</dt>
    <dd>
      <a href={studioInfo.instagram}>{extractInstagramUsername(studioInfo.instagram)}</a>
    </dd>
  </dl>
</main>
